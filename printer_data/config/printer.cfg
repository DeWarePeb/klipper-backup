[include mainsail.cfg]
[include homing.cfg]
[exclude_object]
[force_move]
enable_force_move: True

[mcu]
##--------------------------------------------------------------------
serial: /dev/serial/by-id/usb-Klipper_stm32f446xx_290039000751303532383235-if00
restart_method: command
##--------------------------------------------------------------------

[mcu nhk]
##--------------------------------------------------------------------
serial: /dev/serial/by-id/usb-Klipper_rp2040_4D4A393336174370-if00
restart_method: command
##--------------------------------------------------------------------

[mcu scanner]
serial: /dev/serial/by-id/usb-Cartographer_614e_018016000F43304146393320-if00

[scanner]
mcu: scanner            
x_offset: 0                          
#    adjust for your cartographers offset from nozzle to middle of coil
y_offset: 25                         
#    adjust for your cartographers offset from nozzle to middle of coil
backlash_comp: 0.00232
#   Backlash compensation distance for removing Z backlash before measuring
#   the sensor response.
sensor: cartographer
#    this must be set as cartographer unless using IDM etc.
sensor_alt: carto
#    alternate name to call commands. CARTO_TOUCH etc      
mesh_runs: 2
#    Number of passes to make during mesh scan.

[bed_mesh]
zero_reference_position: 175, 175    
#    set this to the middle of your bed
speed: 400
#    movement speed of toolhead during bed mesh
horizontal_move_z: 5
#    height of scanner during bed mesh scan
mesh_min: 25, 30
#    start point of bed mesh [X, Y]
mesh_max: 325, 325
#    end point of bed mesh [X, Y]
probe_count: 30, 30
algorithm: bicubic

[temperature_sensor Cartographer_MCU]
sensor_type: temperature_mcu
sensor_mcu: scanner
min_temp: 0
max_temp: 105

[printer]
kinematics: corexy
max_velocity: 300  
max_accel: 10000
max_z_velocity: 15          #Max 15 for 12V TMC Drivers, can increase for 24V
max_z_accel: 350
square_corner_velocity: 5.0

#####################################################################
#   X/Y Stepper Settings
#####################################################################

##  B Stepper - Left
##  Connected to HV STEPPER 0
##  Endstop connected to X-ENDSTOP
[stepper_x]
step_pin: PB10
dir_pin: !PB11
enable_pin: !PG0
rotation_distance: 40
microsteps: 32
full_steps_per_rotation: 400  #set to 400 for 0.9 degree stepper
endstop_pin: tmc5160_stepper_x:virtual_endstop
position_min: 0
position_endstop: 300
position_max: 300
homing_speed: 80  #Max 100
homing_retract_dist: 0
homing_positive_dir: true
position_endstop: 350
position_max: 350

##--------------------------------------------------------------------
[tmc5160 stepper_x]
cs_pin: PE15
spi_software_mosi_pin = PE14
spi_software_miso_pin = PE13
spi_software_sclk_pin = PE12
interpolate: True
diag0_pin: ^!PG1 # use the same pin that was previously the endstop_pin! 
driver_SGT: 1
run_current: 0.9
sense_resistor: 0.075
stealthchop_threshold: 0

##  A Stepper - Right
##  Connected to HV STEPPER 1
##  Endstop connected to Y-ENDSTOP
[stepper_y]
step_pin: PF15
dir_pin: !PF14
enable_pin: !PE9
rotation_distance: 40
microsteps: 32
full_steps_per_rotation: 400  #set to 400 for 0.9 degree stepper
endstop_pin: tmc5160_stepper_y:virtual_endstop
position_min: 0
position_endstop: 308
position_max: 310
homing_speed: 80  #Max 100
homing_retract_dist: 0
homing_positive_dir: true
position_endstop: 350
position_max: 350

##--------------------------------------------------------------------
##  Make sure to update below for your relevant driver (2209 or 5160)
[tmc5160 stepper_y]
cs_pin: PE11
spi_software_mosi_pin = PE14
spi_software_miso_pin = PE13
spi_software_sclk_pin = PE12
interpolate: True
diag0_pin: ^!PE10 # use the same pin that was previously the endstop_pin! 
driver_SGT: -2
run_current: 0.9
sense_resistor: 0.075
stealthchop_threshold: 0
#####################################################################
#   Z Stepper Settings
#####################################################################
## Z0 Stepper - Front Left
##  Connected to STEPPER 0
##  Endstop connected to Z-ENDSTOP
[stepper_z]
step_pin: PD4
dir_pin: !PD3
enable_pin: !PD7
rotation_distance: 40
gear_ratio: 80:16  
microsteps: 32
endstop_pin: probe:z_virtual_endstop
position_max: 330

##--------------------------------------------------------------------
position_min: -5
homing_speed: 8
second_homing_speed: 3
homing_retract_dist: 0

##  Make sure to update below for your relevant driver (2209 or 5160)
[tmc2209 stepper_z]
uart_pin: PD5
#diag_pin: ^!PD6
interpolate: false
run_current: 0.8
sense_resistor: 0.110
stealthchop_threshold: 0

##  Z1 Stepper - Rear Left
##  Connected to STEPPER 1
[stepper_z1]
step_pin: PC12
dir_pin: PC11
enable_pin: !PD2
rotation_distance: 40
gear_ratio: 80:16 
microsteps: 32

##  Make sure to update below for your relevant driver (2209 or 5160)
[tmc2209 stepper_z1]
uart_pin: PD0
#diag_pin: ^!PD1
interpolate: false
run_current: 0.8
sense_resistor: 0.110
stealthchop_threshold: 0

##  Z2 Stepper - Rear Right
##  Connected to STEPPER 2
[stepper_z2]
step_pin: PC9
dir_pin: !PC8
enable_pin: !PC10
rotation_distance: 40
gear_ratio: 80:16 
microsteps: 32

##  Make sure to update below for your relevant driver (2209 or 5160)
[tmc2209 stepper_z2]
uart_pin: PA8
#diag_pin: ^!PA15
interpolate: false
run_current: 0.8
sense_resistor: 0.110
stealthchop_threshold: 0

##  Z3 Stepper - Front Right
##  Connected to STEPPER 3
[stepper_z3]
step_pin: PG7
dir_pin: PG6
enable_pin: !PC7
rotation_distance: 40
gear_ratio: 80:16 
microsteps: 32

##  Make sure to update below for your relevant driver (2209 or 5160)
[tmc2209 stepper_z3]
uart_pin: PG8
#diag_pin: ^!PC6
interpolate: false
run_current: 0.8
sense_resistor: 0.110
stealthchop_threshold: 0

#####################################################################
#   Extruder
#####################################################################

##  Connected to STEPPER 0
##  Heater - HEATER
##  Thermistor - TH0
[extruder]
step_pin: nhk:gpio23
dir_pin: nhk:gpio24
enable_pin: !nhk:gpio25
##  Update value below when you perform extruder calibration
##  If you ask for 100mm of filament, but in reality it is 98mm:
##  rotation_distance = <previous_rotation_distance> * <actual_extrude_distance> / 100
##  22.6789511 is a good starting point
rotation_distance: 22.6789511   #Bondtech 5mm Drive Gears
##  Update Gear Ratio depending on your Extruder Type
##  Use 50:10 for Stealthburner/Clockwork 2
##  Use 50:17 for Afterburner/Clockwork (BMG Gear Ratio)
##  Use 80:20 for M4, M3.1
gear_ratio: 50:10               #BMG Gear Ratio
microsteps: 32
full_steps_per_rotation: 200    #200 for 1.8 degree, 400 for 0.9 degree
nozzle_diameter: 0.400
filament_diameter: 1.75
heater_pin: nhk:gpio9
max_extrude_only_distance: 101
## Check what thermistor type you have. See https://www.klipper3d.org/Config_Reference.html#common-thermistors for common thermistor types.
## Use "Generic 3950" for NTC 100k 3950 thermistors
sensor_type: ATC Semitec 104NT-4-R025H42G
sensor_pin: nhk:gpio29
pullup_resistor: 2200
min_temp: 10
max_temp: 270
max_power: 1.0
min_extrude_temp: 170
control = pid
pid_kp = 28.300
pid_ki = 2.948
pid_kd = 67.921
##  Try to keep pressure_advance below 1.0
pressure_advance: 0.016
##  Default is 0.040, leave stock
pressure_advance_smooth_time: 0.040

##  E0 on MOTOR6
##  Connected to STEPPER 4
[tmc2209 extruder]
uart_pin: nhk:gpio0
tx_pin: nhk:gpio1
interpolate: false
run_current: 0.5
sense_resistor: 0.100
stealthchop_threshold: 0


#####################################################################
#   Bed Heater
#####################################################################

[heater_bed]
##  SSR Pin - HEATBED
##  Thermistor - TH1
heater_pin: PG11
sensor_type: ATC Semitec 104NT-4-R025H42G
sensor_pin: PA2
pullup_resistor: 2200
##  Adjust Max Power so your heater doesn't warp your bed. Rule of thumb is 0.4 watts / cm^2 .
max_power: 0.6
min_temp: 0
max_temp: 120
#control: pid
#pid_kp: 58.437
#pid_ki: 2.347
#pid_kd: 363.769

#####################################################################
#   Fan Control
#####################################################################

[fan]
##  Print Cooling Fan - FAN0
pin: nhk:gpio6
##tachometer_pin: PB0
kick_start_time: 0.5
off_below: 0.10

[heater_fan hotend_fan]
##  Hotend Fan - FAN1
pin: nhk:gpio5
#tachometer_pin: PB4
max_power: 1.0
kick_start_time: 0.5
heater: extruder
heater_temp: 50.0
##  If you are experiencing back flow, you can reduce fan_speed
#fan_speed: 1.0

[fan_generic chamber]
pin: PB7
max_power: 1.0
shutdown_speed: 0.0
kick_start_time: 5.0
cycle_time:0.01
off_below:0.1


[controller_fan controller_fan]
##  Controller fan - FAN2
pin: PF7
##tachometer_pin: PF6
kick_start_time: 0.5
heater: heater_bed

[heater_fan exhaust_fan]
##  Exhaust fan - FAN3
pin: PF9
#tachometer_pin: PF8
max_power: 1.0
shutdown_speed: 0.0
kick_start_time: 0.5
heater: heater_bed
heater_temp: 60
fan_speed: 1.0

#####################################################################
#   Filament sensor
#####################################################################

#[filament_switch_sensor Filament]
#pause_on_runout: True
#runout_gcode: M600
#insert_gcode:
#event_delay: 3.0
#pause_delay: 0.5
#switch_pin: !PC0

#####################################################################
#   LED Control
#####################################################################

## Chamber Lighting
[output_pin caselight]
pin: PE6
pwm:true
shutdown_value: 0
value:1                             #the brightness at startup (0-1)
cycle_time: 0.01

## Connected to led (nitehawk sb)
[output_pin pcb_led]
pin: !nhk:gpio8

## Connected to NEOPIXEL (nitehawk sb)
[neopixel rgb_light]
pin: nhk:gpio7
chain_count: 3
color_order: GRBW
initial_RED: 0.0
initial_GREEN: 0.0
initial_BLUE: 0.0
initial_WHITE: 0.0


#####################################################################
#   Accelerometer
#####################################################################
[adxl345]
cs_pin: nhk:gpio21
spi_software_sclk_pin: nhk:gpio18
spi_software_mosi_pin: nhk:gpio20
spi_software_miso_pin: nhk:gpio19

[resonance_tester]
accel_chip: adxl345
probe_points:
    175, 175, 20


#####################################################################
#   TH
# #####################################################################
[temperature_sensor chamber_temp]
## Chamber Temperature - T1
sensor_type: ATC Semitec 104NT-4-R025H42G
sensor_pin: nhk:gpio28
min_temp: 0
max_temp: 100
gcode_id: chamber_th

[thermistor CMFB103F3950FANT]
temperature1: 0.0
resistance1: 32116.0
temperature2: 40.0
resistance2: 5309.0
temperature3: 80.0
resistance3: 1228.0

[temperature_sensor nh_temp]
## Nitehawk PCB Sensor
sensor_type: CMFB103F3950FANT
sensor_pin: nhk:gpio26
pullup_resistor: 2200
min_temp: 0
max_temp: 100
gcode_id: nh_th

[temperature_sensor RPi_Temp]
sensor_type: temperature_host
min_temp: 10
max_temp: 100
#####################################################################
#   Homing and Gantry Adjustment Routines
#####################################################################

[idle_timeout]
timeout: 1800

##  Use QUAD_GANTRY_LEVEL to level a gantry.
##  Min & Max gantry corners - measure from nozzle at MIN (0,0) and 
##  MAX (250, 250), (300,300), or (350,350) depending on your printer size
##  to respective belt positions
[quad_gantry_level]
gantry_corners:
   -60,-10
   410,420
points:
   50,25
   50,275
   300,275
   300,25
speed: 100
horizontal_move_z: 10
retries: 5
retry_tolerance: 0.0075
max_adjust: 10
speed: 200
horizontal_move_z: 10
retries: 5
retry_tolerance: 0.0075

########################################
# EXP1 / EXP2 (display) pins
########################################

[board_pins]
aliases:
    # EXP1 header
    EXP1_1=PG9, EXP1_2=PG12,
    EXP1_3=PG13, EXP1_4=PG14,
    EXP1_5=PC13, EXP1_6=PC14,    # Slot in the socket on this side
    EXP1_7=PC15, EXP1_8=PF0,
    EXP1_9=<GND>, EXP1_10=<5V>,

    # EXP2 header
    EXP2_1=PA6, EXP2_2=PA5,
    EXP2_3=PE2, EXP2_4=PE4,
    EXP2_5=PE3, EXP2_6=PA7,      # Slot in the socket on this side
    EXP2_7=PE5, EXP2_8=<RST>,
    EXP2_9=<GND>, EXP2_10=PE4

#####################################################################
#   Macros
#####################################################################

[gcode_macro G32]
gcode:
    SAVE_GCODE_STATE NAME=STATE_G32
    G90
    G28
    QUAD_GANTRY_LEVEL
    G28

    G0 X175 Y175 Z30 F3600
    #--------------------------------------------------------------------
    RESTORE_GCODE_STATE NAME=STATE_G32
   
#####################################################################
#   A better print_start macro for v2/trident
#####################################################################

[gcode_macro PRINT_START]
gcode:
  # This part fetches data from your slicer. Such as bed, extruder, and chamber temps and size of your printer.
  {% set target_bed = params.BED|int %}
  {% set target_extruder = params.EXTRUDER|int %}
  {% set target_chamber = params.CHAMBER|default("45")|int %}
  {% set x_wait = printer.toolhead.axis_maximum.x|float / 2 %}
  {% set y_wait = printer.toolhead.axis_maximum.y|float / 2 %}

  SET_GCODE_OFFSET Z=0                                 # Set offset to 0

  # Home the printer, set absolute positioning and update the Stealthburner LEDs.
  STATUS_HOMING                                         # Set LEDs to homing-mode
  G28                                                   # Full home (XYZ)
  G90                                                   # Absolute position

  ##  Uncomment for bed mesh (1 of 2 for bed mesh)
  BED_MESH_CLEAR                                       # Clear old saved bed mesh (if any)

  # Check if the bed temp is higher than 90c - if so then trigger a heatsoak.
  {% if params.BED|int > 90 %}
    SET_DISPLAY_TEXT MSG="Bed: {target_bed}c"           # Display info on display
    _LOGO_PENDING                                       # Set LEDs to heating-mode
    M106 S255                                           # Turn on the PT-fan

    ##  Uncomment if you have a Nevermore.
    #SET_PIN PIN=nevermore VALUE=1                      # Turn on the nevermore

    G1 X{x_wait} Y{y_wait} Z15 F9000                    # Go to center of the bed
    M190 S{target_bed}                                  # Set the target temp for the bed
    SET_DISPLAY_TEXT MSG="Heatsoak: {target_chamber}c"  # Display info on display
    TEMPERATURE_WAIT SENSOR="temperature_sensor chamber" MINIMUM={target_chamber}   # Waits for chamber temp

  # If the bed temp is not over 90c, then skip the heatsoak and just heat up to set temp with a 5 min soak
  {% else %}
    SET_DISPLAY_TEXT MSG="Bed: {target_bed}c"           # Display info on display
    _LOGO_PENDING                                     # Set LEDs to heating-mode
    G1 X{x_wait} Y{y_wait} Z15 F9000                    # Go to center of the bed
    M190 S{target_bed}                                  # Set the target temp for the bed
    SET_DISPLAY_TEXT MSG="Soak for 5 min"               # Display info on display
    #G4 P300000                                          # Wait 5 min for the bedtemp to stabilize
  {% endif %}

  # Heat hotend to 150c. This helps with getting a correct Z-home.
  SET_DISPLAY_TEXT MSG="Hotend: 150c"                   # Display info on display
  M109 S150                                             # Heat hotend to 150c

  ##  Uncomment for V2.4 (Quad gantry level AKA QGL)
  #CLEAN_NOZZLE
  SET_DISPLAY_TEXT MSG="Leveling"                      # Display info on display
  _LOGO_PENDING                                    # Set LEDs to leveling-mode
  QUAD_GANTRY_LEVEL                                    # Level the printer via QGL
  G28 Z                                                # Home Z again after QGL

  ##  Uncomment for bed mesh (2 of 2 for bed mesh)
  SET_DISPLAY_TEXT MSG="Bed mesh"                      # Display info on display
 _LOGO_PENDING                                       # Set LEDs to bed mesh-mode
  BED_MESH_CALIBRATE                                   # Start the bed mesh (add ADAPTIVE=1) for adaptive bed mesh

  CARTOGRAPHER_TOUCH                                    # Calibrate z offset only with hot nozzle

  # Heat up the hotend up to target via data from slicer
  SET_DISPLAY_TEXT MSG="Hotend: {target_extruder}c"     # Display info on display
  _LOGO_PENDING  
  _HEADLIGHT_ON                                      # Set LEDs to heating-mode
  G1 X{x_wait} Y{y_wait} Z15 F9000                      # Go to center of the bed
  M107                                                  # Turn off partcooling fan
  M109 S{target_extruder}                               # Heat the hotend to set temp

  # Get ready to print by doing a primeline and updating the LEDs
  SET_DISPLAY_TEXT MSG="Printer goes brr"               # Display info on display
  _LOGO_READY                                      # Set LEDs to printing-mode
  G0 X{x_wait - 50} Y4 F10000                           # Go to starting point
  G0 Z0.4                                               # Raise Z to 0.4
  G91                                                   # Incremental positioning 
  G1 X100 E20 F1000                                     # Primeline
  G90                                                   # Absolute position
   

[gcode_macro PRINT_END]
#   Use PRINT_END for the slicer ending script - please customise for your slicer of choice
gcode:
  _LOGO_OFF
  _HEADLIGHT_OFF
    # safe anti-stringing move coords
    {% set th = printer.toolhead %}
    {% set x_safe = th.position.x + 20 * (1 if th.axis_maximum.x - th.position.x > 20 else -1) %}
    {% set y_safe = th.position.y + 20 * (1 if th.axis_maximum.y - th.position.y > 20 else -1) %}
    {% set z_safe = [th.position.z + 2, th.axis_maximum.z]|min %}
    
    SAVE_GCODE_STATE NAME=STATE_PRINT_END
    
    M400                           ; wait for buffer to clear
    G92 E0                         ; zero the extruder
    G1 E-5.0 F1800                 ; retract filament
    
    TURN_OFF_HEATERS
    
    G90                                      ; absolute positioning
    G0 X{x_safe} Y{y_safe} Z{z_safe} F20000  ; move nozzle to remove stringing
    G0 X{th.axis_maximum.x//2} Y{th.axis_maximum.y - 2} F3600  ; park nozzle at rear
    M107                                     ; turn off fan
    
    BED_MESH_CLEAR
    RESTORE_GCODE_STATE NAME=STATE_PRINT_END

[gcode_macro CHOME]
description: Homes XYZ axis only if printer is in a non-homed state
gcode:
  {% if "xyz" not in printer.toolhead.homed_axes %}
    G28
  {% endif %}

[gcode_macro FRONT]
description: Moves the toolhead to the front
gcode:
  CHOME
  {% set x_center = printer.toolhead.axis_maximum.x|float / 2.0 %}
  {% set y_center = printer.toolhead.axis_maximum.y|float / 2.0 %}
  G90
  G1 X{x_center} Y10 F7800

[gcode_macro _LOGO_PENDING]
gcode:
  SET_LED LED=rgb_light RED=0.15 GREEN=0.5 BLUE=0.75 WHITE=0 INDEX=1

[gcode_macro _LOGO_READY]
gcode:
  SET_LED LED=rgb_light RED=0.99 GREEN=0.0 BLUE=0.0 WHITE=0 INDEX=1

[gcode_macro _LOGO_OFF]
gcode:
  SET_LED LED=rgb_light RED=0 GREEN=0 BLUE=0 WHITE=0 INDEX=1
  

[gcode_macro _HEADLIGHT_ON]
gcode:
  SET_LED LED=rgb_light RED=1 GREEN=1 BLUE=1 WHITE=1.0 INDEX=2 TRANSMIT=0
  SET_LED LED=rgb_light RED=1 GREEN=1 BLUE=1 WHITE=1.0 INDEX=3


[gcode_macro _HEADLIGHT_OFF]
gcode:
  SET_LED LED=rgb_light RED=0 GREEN=0 BLUE=0 WHITE=0 INDEX=2 TRANSMIT=0
  SET_LED LED=rgb_light RED=0 GREEN=0 BLUE=0 WHITE=0 INDEX=3
  

[gcode_macro UNLOAD_FILAMENT]
description: Unloads filament from toolhead
gcode:
  {% set EXTRUDER_TEMP = params.TEMP|default(230)|int %}
  {% set MIN_TEMP = params.TEMP|default(230)|float * 0.98 %}
  {% set CURRENT_TARGET = printer.extruder.target|float %}
  CHOME
  G91                         ; relative positioning
  G1 Z20                      ; move nozzle upwards
  FRONT                       ; move the toolhead to the front
  {% if EXTRUDER_TEMP != 0 %}
    _LOGO_PENDING
    {% if CURRENT_TARGET < EXTRUDER_TEMP %}
      M104 S{EXTRUDER_TEMP} ; only heat up if the current extruder is not already hot
    {% endif %}
    TEMPERATURE_WAIT SENSOR="extruder" MINIMUM={MIN_TEMP} ; wait for min extrude temp to reach
  {% endif %}
  _LOGO_READY
  M83                         ; set extruder to relative mode
  G1 E10 F300                 ; extrude a little to soften tip
  G1 E-8 F3600                ; quickly retract a small amount to elimate stringing
  G4 P200                     ; pause for a short amount of time
  G1 E-50 F400                ; retract slowly the rest of the way
  G1 E-20 F300
  M400                        ; wait for moves to finish
  M117 Unload Complete!
  _LOGO_OFF

[gcode_macro LOAD_FILAMENT]
description: Loads new filament into toolhead
gcode:
  {% set EXTRUDER_TEMP = params.TEMP|default(230)|int %}
  {% set MIN_TEMP = params.TEMP|default(230)|float * 0.98 %}
  {% set CURRENT_TARGET = printer.extruder.target|float %}
  FRONT                       ; move the toolhead to the front
  {% if EXTRUDER_TEMP != 0 %}
    _LOGO_PENDING
    {% if CURRENT_TARGET < EXTRUDER_TEMP %}
      M104 S{EXTRUDER_TEMP} ; only heat up if the current extruder is not already hot
    {% endif %}
    TEMPERATURE_WAIT SENSOR="extruder" MINIMUM={MIN_TEMP} ; wait for min extrude temp to reach
  {% endif %}
  _LOGO_READY
  _HEADLIGHT_ON
  M83                         ; set extruder to relative mode
  G1 E50 F300                 ; extrude slowlyL
  G1 E50 F300
  M400                        ; wait for moves to finish
  M117 Load Complete!
  _LOGO_OFF
  _HEADLIGHT_OFF

[gcode_macro CLEAN_NOZZLE]

variable_start_x: 311 # starting position - offset a bit to the right from the brush
variable_start_y: 346 # starting Y position - offset a bit to the front of the brush
variable_start_z: 3   #starting Z height. This should barely touch the surface of the brush
variable_x_min: 274     #left side of the brush 
variable_x_max: 308     #right side of the brush
variable_y_min: 348 #front side of the brush - make sure the nozzle is over the last line of bristles 
variable_y_max: 350 #rear side of the brush - make sure the nozzle is over the first line of bristles
variable_z1: 2.2 # second z height of the nozzle over the brush - this should be with the nozzle slightly sunk in
variable_z2: 2 # third z height of the nozzle over the brush - this should be with the nozzle fully sunk into the brush, but not touching the bottom of it.
variable_wipe_qty: 2 #how many times to run the cleaning sequence
variable_wipe_spd: 200 #cleaning speed
variable_raise_distance: 30 # z height after cleaning is done
gcode:
  
  {% if "xyz" not in printer.toolhead.homed_axes %}
    G28
  {% endif %}
  
  G90  ; absolute positioning
  ### Move nozzle to start position
  G1 X{start_x} Y{start_y} F9000
  G1 X{x_max} Y{y_min} F9000
  G1 Z{start_z} F1500
  ### Wipe nozzle
  {% for wipes in range(1, (wipe_qty + 1)) %} #wipe left and right
    G1 Y{y_min} F{wipe_spd * 60}
    G1 X{x_min} F{wipe_spd * 60}
    G1 X{start_x} F{wipe_spd * 60}
    
    G1 Y{y_max} F{wipe_spd * 60}
    G1 X{x_min} F{wipe_spd * 60}
    G1 X{start_x} F{wipe_spd * 60}
    G1 Z{z1} F1500
    G1 Y{y_min} F{wipe_spd * 60}
    G1 X{x_min} F{wipe_spd * 60}
    G1 X{start_x} F{wipe_spd * 60}
    
    G1 Y{y_max} F{wipe_spd * 60}
    G1 X{x_min} F{wipe_spd * 60}
    G1 X{start_x} F{wipe_spd * 60}
    G1 Z{z2} F1500
    G1 Y{y_min} F{wipe_spd * 60}
    G1 X{x_min} F{wipe_spd * 60}
    G1 X{start_x} F{wipe_spd * 60}
    
    G1 Y{y_max} F{wipe_spd * 60}
    G1 X{x_min} F{wipe_spd * 60}
    G1 X{start_x} F{wipe_spd * 60}
    
    G1 Z{start_z} F1500
  {% endfor %}
  
  {% for wipes in range(1, (wipe_qty + 1)) %} #wipe diagonally
    G1 Z{start_z} F1500
    G1 X{x_min} Y{y_min} F{wipe_spd * 60}
    G1 X{x_max} Y{y_max} F{wipe_spd * 60}
    G1 X{x_min} Y{y_min} F{wipe_spd * 60}
    G1 X{x_max} Y{y_max} F{wipe_spd * 60}
    G1 Z{z1} F1500
    G1 X{x_min} Y{y_min} F{wipe_spd * 60}
    G1 X{x_max} Y{y_max} F{wipe_spd * 60}
    G1 X{x_min} Y{y_min} F{wipe_spd * 60}
    G1 X{x_max} Y{y_max} F{wipe_spd * 60}
   G1 Z{z1} F1500
    G1 X{x_min} Y{y_max} F{wipe_spd * 60}
    G1 X{x_max} Y{y_min} F{wipe_spd * 60}
    G1 X{x_min} Y{y_max} F{wipe_spd * 60}
    G1 X{x_max} Y{y_min} F{wipe_spd * 60}
    G1 Z{z2} F1500
    G1 X{x_min} Y{y_min} F{wipe_spd * 60}
    G1 X{x_max} Y{y_max} F{wipe_spd * 60}
    G1 X{x_min} Y{y_min} F{wipe_spd * 60}
    G1 X{x_max} Y{y_max} F{wipe_spd * 60}
    G1 X{x_min} Y{y_max} F{wipe_spd * 60}
    G1 X{x_max} Y{y_min} F{wipe_spd * 60}
    G1 X{x_min} Y{y_max} F{wipe_spd * 60}
    G1 X{x_max} Y{y_min} F{wipe_spd * 60}
    G1 X{start_x} Y{y_min} F{wipe_spd * 60}
    
    G1 Z{start_z} F1500
  {% endfor %}
  
  G1 X{start_x} Y{start_y} F9000 #go back to starting position
  ## Raise nozzle
  G1 Z{raise_distance} 

[gcode_macro TEST_SPEED]
# Home, get position, throw around toolhead, home again.
# If MCU stepper positions (first line in GET_POSITION) are greater than a full step different (your number of microsteps), then skipping occured.
# We only measure to a full step to accomodate for endstop variance.
# Example: TEST_SPEED SPEED=300 ACCEL=5000 ITERATIONS=10

description: Test for max speed and acceleration parameters for the printer. Procedure: Home -> ReadPositionFromMCU -> MovesToolhead@Vel&Accel -> Home -> ReadPositionfromMCU

gcode:
    # Speed
    {% set speed  = params.SPEED|default(printer.configfile.settings.printer.max_velocity)|int %}
    # Iterations
    {% set iterations = params.ITERATIONS|default(5)|int %}
    # Acceleration
    {% set accel  = params.ACCEL|default(printer.configfile.settings.printer.max_accel)|int %}
    # Minimum Cruise Ratio
    {% set min_cruise_ratio = params.MIN_CRUISE_RATIO|default(0.5)|float %}
    # Bounding inset for large pattern (helps prevent slamming the toolhead into the sides after small skips, and helps to account for machines with imperfectly set dimensions)
    {% set bound = params.BOUND|default(20)|int %}
    # Size for small pattern box
    {% set smallpatternsize = SMALLPATTERNSIZE|default(20)|int %}
    
    # Large pattern
        # Max positions, inset by BOUND
        {% set x_min = printer.toolhead.axis_minimum.x %}
        {% if x_min < 0 %}
            {% set x_min = 0 %}
        {% endif %}
    
        {% set y_min = printer.toolhead.axis_minimum.y %}
        {% if y_min < 0 %}
            {% set y_min = 0 %}
        {% endif %}
    
        {% set x_min = x_min + bound %}
        {% set x_max = printer.toolhead.axis_maximum.x - bound %}
        {% set y_min = y_min + bound %}
        {% set y_max = printer.toolhead.axis_maximum.y - bound %}
    
    # Small pattern at center
        # Find X/Y center point
        {% set x_center = (printer.toolhead.axis_minimum.x|float + printer.toolhead.axis_maximum.x|float ) / 2 %}
        {% set y_center = (printer.toolhead.axis_minimum.y|float + printer.toolhead.axis_maximum.y|float ) / 2 %}
        
        # Set small pattern box around center point
        {% set x_center_min = x_center - (smallpatternsize/2) %}
        {% set x_center_max = x_center + (smallpatternsize/2) %}
        {% set y_center_min = y_center - (smallpatternsize/2) %}
        {% set y_center_max = y_center + (smallpatternsize/2) %}

    # Save current gcode state (absolute/relative, etc)
    SAVE_GCODE_STATE NAME=TEST_SPEED
    
    # Output parameters to g-code terminal
    { action_respond_info("TEST_SPEED: starting %d iterations at speed %d, accel %d" % (iterations, speed, accel)) }
    
    # Home and get position for comparison later:
        M400 # Finish moves - https://github.com/AndrewEllis93/Print-Tuning-Guide/issues/66
        G28
        # QGL if not already QGLd (only if QGL section exists in config)
        {% if printer.configfile.settings.quad_gantry_level %}
            {% if printer.quad_gantry_level.applied == False %}
                QUAD_GANTRY_LEVEL
                G28 Z
            {% endif %}
        {% endif %} 
        # Move 50mm away from max position and home again (to help with hall effect endstop accuracy - https://github.com/AndrewEllis93/Print-Tuning-Guide/issues/24)
        G90
        G1 X{printer.toolhead.axis_maximum.x-50} Y{printer.toolhead.axis_maximum.y-50} F{30*60}
        M400 # Finish moves - https://github.com/AndrewEllis93/Print-Tuning-Guide/issues/66
        G28 X Y
        G0 X{printer.toolhead.axis_maximum.x-1} Y{printer.toolhead.axis_maximum.y-1} F{30*60}
        G4 P1000 
        GET_POSITION

    # Go to starting position
    G0 X{x_min} Y{y_min} Z{bound + 10} F{speed*60}

    # Set new limits
    {% if printer.configfile.settings.printer.minimum_cruise_ratio is defined %}
        SET_VELOCITY_LIMIT VELOCITY={speed} ACCEL={accel} MINIMUM_CRUISE_RATIO={min_cruise_ratio}
    {% else %}
        SET_VELOCITY_LIMIT VELOCITY={speed} ACCEL={accel} ACCEL_TO_DECEL={accel / 2}
    {% endif %}

    {% for i in range(iterations) %}
        # Large pattern diagonals
        G0 X{x_min} Y{y_min} F{speed*60}
        G0 X{x_max} Y{y_max} F{speed*60}
        G0 X{x_min} Y{y_min} F{speed*60}
        G0 X{x_max} Y{y_min} F{speed*60}
        G0 X{x_min} Y{y_max} F{speed*60}
        G0 X{x_max} Y{y_min} F{speed*60}
        
        # Large pattern box
        G0 X{x_min} Y{y_min} F{speed*60}
        G0 X{x_min} Y{y_max} F{speed*60}
        G0 X{x_max} Y{y_max} F{speed*60}
        G0 X{x_max} Y{y_min} F{speed*60}
    
        # Small pattern diagonals
        G0 X{x_center_min} Y{y_center_min} F{speed*60}
        G0 X{x_center_max} Y{y_center_max} F{speed*60}
        G0 X{x_center_min} Y{y_center_min} F{speed*60}
        G0 X{x_center_max} Y{y_center_min} F{speed*60}
        G0 X{x_center_min} Y{y_center_max} F{speed*60}
        G0 X{x_center_max} Y{y_center_min} F{speed*60}
        
        # Small pattern box
        G0 X{x_center_min} Y{y_center_min} F{speed*60}
        G0 X{x_center_min} Y{y_center_max} F{speed*60}
        G0 X{x_center_max} Y{y_center_max} F{speed*60}
        G0 X{x_center_max} Y{y_center_min} F{speed*60}
    {% endfor %}

    # Restore max speed/accel/accel_to_decel to their configured values
    {% if printer.configfile.settings.printer.minimum_cruise_ratio is defined %}
        SET_VELOCITY_LIMIT VELOCITY={printer.configfile.settings.printer.max_velocity} ACCEL={printer.configfile.settings.printer.max_accel} MINIMUM_CRUISE_RATIO={printer.configfile.settings.printer.minimum_cruise_ratio} 
    {% else %}
        SET_VELOCITY_LIMIT VELOCITY={printer.configfile.settings.printer.max_velocity} ACCEL={printer.configfile.settings.printer.max_accel} ACCEL_TO_DECEL={printer.configfile.settings.printer.max_accel_to_decel}
    {% endif %}

    # Re-home and get position again for comparison:
        M400 # Finish moves - https://github.com/AndrewEllis93/Print-Tuning-Guide/issues/66
        G28 # This is a full G28 to fix an issue with CoreXZ - https://github.com/AndrewEllis93/Print-Tuning-Guide/issues/12
        # Go to XY home positions (in case your homing override leaves it elsewhere)
        G90
        G0 X{printer.toolhead.axis_maximum.x-1} Y{printer.toolhead.axis_maximum.y-1} F{30*60}
        G4 P1000 
        GET_POSITION

    # Restore previous gcode state (absolute/relative, etc)
    RESTORE_GCODE_STATE NAME=TEST_SPEED

[include moonraker_obico_macros.cfg]

#*# <---------------------- SAVE_CONFIG ---------------------->
#*# DO NOT EDIT THIS BLOCK OR BELOW. The contents are auto-generated.
#*#
#*# [scanner]
#*# mode = touch
#*# scanner_touch_threshold = 1250
#*# scanner_touch_speed = 3
#*# scanner_touch_z_offset = 0.000
#*#
#*# [scanner model default]
#*# model_coef = 1.4441329075789051,
#*# 	  1.8671257332614302,
#*# 	  0.7613414581790721,
#*# 	  0.3937672233449477,
#*# 	  0.3028195561068426,
#*# 	  0.17014071271520456,
#*# 	  -0.14747627689260262,
#*# 	  -0.09421432241840184,
#*# 	  0.1906713965470342,
#*# 	  0.11581408946473486
#*# model_domain = 3.2484978803571655e-07,3.343484721555115e-07
#*# model_range = 0.100000,5.000000
#*# model_temp = 33.536224
#*# model_offset = 0.00000
#*# model_mode = touch
#*# model_fw_version = CARTOGRAPHER 5.1.0
#*#
#*# [bed_mesh default]
#*# version = 1
#*# points =
#*# 	0.091267, 0.072084, 0.057694, 0.066006, 0.059274, 0.053514, 0.033917, 0.045290, 0.042068, 0.054252, 0.037733, 0.035961, 0.032472, 0.042775, 0.026287, 0.023634, 0.020708, 0.029788, 0.016359, 0.016767, 0.018037, 0.022788, 0.029945, 0.038492, 0.047172, 0.055070, 0.064724, 0.069574, 0.087899, 0.100305
#*# 	0.086977, 0.080601, 0.070100, 0.063340, 0.053030, 0.052514, 0.046263, 0.042595, 0.035513, 0.037394, 0.036051, 0.033514, 0.030371, 0.025697, 0.022063, 0.021477, 0.019743, 0.015742, 0.020368, 0.016430, 0.017613, 0.023730, 0.038437, 0.038921, 0.048220, 0.058306, 0.074939, 0.078361, 0.088892, 0.091040
#*# 	0.092716, 0.096064, 0.074870, 0.067869, 0.061510, 0.071477, 0.049868, 0.044644, 0.040578, 0.038705, 0.035874, 0.032118, 0.028919, 0.026006, 0.023213, 0.009054, 0.019041, 0.018241, 0.017479, 0.006657, 0.019183, 0.023958, 0.040471, 0.028656, 0.048799, 0.057940, 0.075650, 0.077732, 0.089523, 0.098795
#*# 	0.095593, 0.083774, 0.073759, 0.068595, 0.060904, 0.058420, 0.048590, 0.044854, 0.039250, 0.040344, 0.032837, 0.029335, 0.022132, 0.027493, 0.021251, 0.019344, 0.013615, 0.018642, 0.019426, 0.016992, 0.011282, 0.022177, 0.027774, 0.034919, 0.035891, 0.054909, 0.065256, 0.076700, 0.087019, 0.096174
#*# 	0.100452, 0.088529, 0.080304, 0.058322, 0.065089, 0.058437, 0.053013, 0.034752, 0.042765, 0.038900, 0.049816, 0.033722, 0.030163, 0.027794, 0.036418, 0.024001, 0.023865, 0.021666, 0.031643, 0.020389, 0.020923, 0.024599, 0.028353, 0.036022, 0.045381, 0.054907, 0.064864, 0.075312, 0.079369, 0.093481
#*# 	0.114856, 0.102821, 0.093052, 0.082791, 0.078548, 0.070994, 0.064715, 0.055955, 0.055432, 0.050872, 0.048421, 0.045613, 0.042791, 0.039446, 0.036194, 0.034637, 0.032788, 0.036691, 0.029816, 0.028261, 0.029390, 0.038815, 0.037835, 0.043495, 0.052332, 0.067616, 0.070623, 0.080037, 0.084588, 0.100275
#*# 	0.124352, 0.116579, 0.119776, 0.099085, 0.092117, 0.085628, 0.091775, 0.073381, 0.066965, 0.064331, 0.060574, 0.057154, 0.055936, 0.051688, 0.048256, 0.046671, 0.035008, 0.042500, 0.040004, 0.039563, 0.032813, 0.044897, 0.048883, 0.061767, 0.056207, 0.071055, 0.079258, 0.095476, 0.101314, 0.109721
#*# 	0.132723, 0.123825, 0.115735, 0.106424, 0.104039, 0.092392, 0.086092, 0.079941, 0.076230, 0.069212, 0.064647, 0.059425, 0.065031, 0.056727, 0.056138, 0.048866, 0.051597, 0.049630, 0.047266, 0.041976, 0.048956, 0.053203, 0.057495, 0.063612, 0.070502, 0.078846, 0.088160, 0.098808, 0.109163, 0.125670
#*# 	0.124847, 0.116358, 0.108560, 0.100861, 0.081844, 0.085843, 0.080746, 0.075878, 0.058221, 0.064942, 0.059731, 0.067328, 0.043914, 0.051531, 0.048946, 0.056148, 0.046304, 0.044411, 0.043750, 0.052094, 0.045228, 0.048520, 0.053332, 0.058657, 0.067647, 0.076010, 0.085244, 0.095273, 0.106025, 0.110666
#*# 	0.107043, 0.097547, 0.086777, 0.081558, 0.072362, 0.067276, 0.058501, 0.058789, 0.052807, 0.050519, 0.047034, 0.044486, 0.040308, 0.035137, 0.031330, 0.030335, 0.036186, 0.030449, 0.030163, 0.030589, 0.036574, 0.034362, 0.040376, 0.041645, 0.061230, 0.065843, 0.074862, 0.079013, 0.096092, 0.104813
#*# 	0.079797, 0.082776, 0.073031, 0.076040, 0.058885, 0.053145, 0.048304, 0.052620, 0.039750, 0.037781, 0.035693, 0.033228, 0.028078, 0.024530, 0.020460, 0.018435, 0.019061, 0.008840, 0.017083, 0.018390, 0.020681, 0.018315, 0.028446, 0.035568, 0.045113, 0.049972, 0.064497, 0.075005, 0.089108, 0.095290
#*# 	0.080835, 0.071506, 0.062763, 0.057359, 0.048269, 0.042841, 0.038239, 0.035995, 0.031524, 0.029919, 0.024877, 0.024869, 0.021431, 0.016090, 0.010212, 0.010655, 0.011193, 0.010020, 0.006771, 0.013516, 0.015914, 0.017534, 0.022902, 0.029080, 0.038715, 0.048319, 0.059427, 0.072920, 0.091341, 0.091787
#*# 	0.077217, 0.069463, 0.061190, 0.053145, 0.045631, 0.032248, 0.034081, 0.031176, 0.028272, 0.020173, 0.025463, 0.022599, 0.025892, 0.004058, 0.008046, 0.006847, 0.015970, 0.009238, 0.011926, 0.012633, 0.022503, 0.018449, 0.021627, 0.026828, 0.037007, 0.048831, 0.062760, 0.080034, 0.094601, 0.104890
#*# 	0.077050, 0.066918, 0.060993, 0.052278, 0.045563, 0.038216, 0.033854, 0.029134, 0.026533, 0.026723, 0.023665, 0.019760, 0.016017, 0.011778, 0.008532, 0.011368, 0.008909, 0.009638, 0.011859, 0.016402, 0.016427, 0.019391, 0.019665, 0.032058, 0.036627, 0.050058, 0.064091, 0.088006, 0.108200, 0.117213
#*# 	0.080092, 0.055697, 0.055112, 0.047809, 0.048613, 0.033969, 0.028896, 0.025730, 0.029624, 0.020597, 0.018548, 0.014227, 0.012424, 0.008773, 0.005875, 0.006758, 0.007221, 0.007295, 0.003238, 0.011060, 0.012285, 0.014658, 0.014964, 0.024871, 0.036104, 0.050220, 0.071905, 0.095059, 0.114593, 0.130201
#*# 	0.068446, 0.058779, 0.049742, 0.042671, 0.035535, 0.028177, 0.024841, 0.020429, 0.017463, 0.014670, 0.012998, 0.009680, 0.007797, 0.002431, 0.002810, 0.002864, 0.002326, -0.000504, 0.004112, 0.006069, 0.006918, 0.009998, 0.013981, 0.021679, 0.033957, 0.052198, 0.075086, 0.103913, 0.123489, 0.135151
#*# 	0.070203, 0.060706, 0.051641, 0.044259, 0.038163, 0.031458, 0.019719, 0.022480, 0.018159, 0.016399, 0.008522, 0.011418, 0.009719, 0.007769, 0.000010, 0.003783, 0.003406, 0.009142, 0.005134, 0.006627, 0.007620, 0.013677, 0.014164, 0.021699, 0.036778, 0.057572, 0.082982, 0.110868, 0.130343, 0.145705
#*# 	0.074259, 0.064019, 0.054456, 0.047177, 0.040143, 0.036327, 0.031285, 0.025846, 0.021494, 0.019457, 0.018460, 0.014804, 0.013737, 0.012597, 0.013329, 0.008972, 0.007366, 0.008610, 0.011952, 0.010850, 0.012194, 0.012511, 0.019249, 0.027109, 0.042256, 0.060177, 0.087996, 0.113764, 0.137197, 0.147337
#*# 	0.081721, 0.071068, 0.053671, 0.050842, 0.046768, 0.049450, 0.038889, 0.034562, 0.032196, 0.036921, 0.028107, 0.024264, 0.022671, 0.020785, 0.019558, 0.017448, 0.017473, 0.016976, 0.018082, 0.020383, 0.022393, 0.025752, 0.030518, 0.034041, 0.049411, 0.068125, 0.092128, 0.117810, 0.139367, 0.154603
#*# 	0.090280, 0.080710, 0.069786, 0.062793, 0.056818, 0.052800, 0.048927, 0.046348, 0.044134, 0.044420, 0.040930, 0.037178, 0.034061, 0.033730, 0.030904, 0.030404, 0.029640, 0.028266, 0.029974, 0.033730, 0.034780, 0.038555, 0.042712, 0.048563, 0.057598, 0.075096, 0.098991, 0.118543, 0.142253, 0.157872
#*# 	0.096977, 0.086664, 0.078823, 0.071200, 0.065397, 0.060205, 0.056192, 0.053477, 0.050092, 0.049374, 0.047015, 0.038522, 0.041198, 0.040123, 0.037247, 0.033593, 0.035415, 0.034378, 0.039026, 0.038394, 0.040637, 0.044264, 0.051688, 0.055907, 0.067114, 0.078746, 0.096949, 0.118408, 0.139182, 0.155204
#*# 	0.093909, 0.086315, 0.078016, 0.070209, 0.064412, 0.059346, 0.054355, 0.053857, 0.049268, 0.045981, 0.042926, 0.040046, 0.039478, 0.037700, 0.034153, 0.031521, 0.030762, 0.031599, 0.032571, 0.034854, 0.037985, 0.044054, 0.049674, 0.056729, 0.066326, 0.078331, 0.092339, 0.109354, 0.128092, 0.143048
#*# 	0.095445, 0.084292, 0.075845, 0.064407, 0.060272, 0.056921, 0.056354, 0.050532, 0.047856, 0.042736, 0.043578, 0.038700, 0.036601, 0.033820, 0.034029, 0.029184, 0.029356, 0.030105, 0.030666, 0.032459, 0.035697, 0.041794, 0.047314, 0.056496, 0.067737, 0.078425, 0.091392, 0.104903, 0.118800, 0.134266
#*# 	0.096468, 0.088412, 0.079406, 0.072075, 0.065506, 0.060537, 0.054269, 0.052798, 0.050563, 0.047154, 0.043203, 0.041063, 0.040145, 0.036299, 0.034707, 0.033879, 0.033116, 0.032051, 0.034009, 0.034663, 0.036984, 0.041661, 0.047966, 0.057659, 0.069806, 0.083754, 0.092622, 0.104810, 0.117730, 0.127025
#*# 	0.098046, 0.089085, 0.084824, 0.073904, 0.067286, 0.061602, 0.055246, 0.051649, 0.049355, 0.047237, 0.044335, 0.043848, 0.040283, 0.040250, 0.037759, 0.036830, 0.034910, 0.036737, 0.037420, 0.037162, 0.035028, 0.040807, 0.046712, 0.054658, 0.066639, 0.079553, 0.091209, 0.102715, 0.113276, 0.124861
#*# 	0.092723, 0.084520, 0.077051, 0.067404, 0.060033, 0.054752, 0.048423, 0.043889, 0.041610, 0.039642, 0.036337, 0.036108, 0.033867, 0.032148, 0.030979, 0.030176, 0.029058, 0.027077, 0.029102, 0.029256, 0.026590, 0.030466, 0.036651, 0.043713, 0.053649, 0.066314, 0.078889, 0.090028, 0.101286, 0.112293
#*# 	0.083582, 0.078269, 0.067638, 0.060043, 0.049418, 0.045463, 0.038727, 0.035135, 0.032659, 0.032470, 0.028212, 0.027211, 0.023484, 0.021389, 0.021019, 0.020966, 0.016963, 0.015030, 0.018033, 0.018230, 0.017052, 0.020314, 0.025879, 0.032539, 0.040348, 0.051740, 0.064675, 0.075244, 0.086214, 0.098623
#*# 	0.095838, 0.085128, 0.077760, 0.065535, 0.059135, 0.051817, 0.046317, 0.039335, 0.036549, 0.035236, 0.033556, 0.031535, 0.029421, 0.026757, 0.024769, 0.024803, 0.021931, 0.022926, 0.025050, 0.025805, 0.024598, 0.024715, 0.029398, 0.034452, 0.043522, 0.053761, 0.064376, 0.075140, 0.086661, 0.097141
#*# 	0.104583, 0.091854, 0.084533, 0.077356, 0.069345, 0.062827, 0.058051, 0.050683, 0.046716, 0.045861, 0.045671, 0.043609, 0.041765, 0.037345, 0.034305, 0.031750, 0.031784, 0.032130, 0.035666, 0.036545, 0.034585, 0.036094, 0.040482, 0.046637, 0.053329, 0.064821, 0.074305, 0.083113, 0.093153, 0.106989
#*# 	0.109326, 0.090442, 0.083509, 0.077588, 0.073288, 0.067318, 0.063257, 0.056859, 0.054468, 0.053230, 0.052486, 0.048485, 0.046497, 0.042011, 0.038674, 0.033953, 0.035952, 0.035986, 0.038620, 0.039847, 0.040601, 0.042783, 0.047792, 0.053805, 0.062766, 0.071342, 0.078679, 0.088068, 0.100469, 0.112341
#*# x_count = 30
#*# y_count = 30
#*# mesh_x_pps = 2
#*# mesh_y_pps = 2
#*# algo = bicubic
#*# tension = 0.2
#*# min_x = 25.0
#*# max_x = 325.0
#*# min_y = 30.0
#*# max_y = 325.0
#*#
#*# [heater_bed]
#*# control = pid
#*# pid_kp = 37.724
#*# pid_ki = 1.170
#*# pid_kd = 304.147
#*#
#*# [input_shaper]
#*# shaper_type_x = ei
#*# shaper_freq_x = 73.4
#*# shaper_type_y = zv
#*# shaper_freq_y = 44.2
